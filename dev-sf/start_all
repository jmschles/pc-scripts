current_dir=`pwd`
cms_pid=`screen -ls | grep cms_main | awk -F '.' '{print $1}'`
if [ -z "$cms_pid" ]
then
  cd ~/cms/current
  screen -S cms_main -d -m bundle exec unicorn -p 3002
  echo "cms started"
else
  echo "could not start cms: app is already running"
fi
cms_api_pid=`screen -ls | grep cms_api | awk -F '.' '{print $1}'`
if [ -z "$cms_api_pid" ]
then
  cd ~/cms_api/current
  screen -S cms_api -d -m bundle exec unicorn -p 3001
  echo "cms_api started"
else
  echo "could not start cms_api: app is already running"
fi
storage_pid=`screen -ls | grep storage | awk -F '.' '{print $1}'`
if [ -z "$storage_pid" ]
then
  cd ~/storage/current
  screen -S storage -d -m bundle exec unicorn -p 3003
  echo "storage started"
else
  echo "could not start storage: app is already running"
fi
uploader_pid=`screen -ls | grep uploader | awk -F '.' '{print $1}'`
if [ -z "$uploader_pid" ]
then
  cd ~/uploader/current
  screen -S uploader -d -m bundle exec unicorn -p 3004
  echo "uploader started"
else
  echo "could not start uploader: app is already running"
fi
jobs_pid=`screen -ls | grep jobs | awk -F '.' '{print $1}'`
if [ -z "$jobs_pid" ]
then
  cd ~/jobs/current
  screen -S jobs -d -m bundle exec unicorn -p 3005
  echo "jobs started"
else
  echo "could not start jobs: app is already running"
fi
# utility_pid=`screen -ls | grep utility | awk -F '.' '{print $1}'`
# if [ -z "$utility_pid" ]
# then
#   cd ~/utility/current
#   screen -S utility -d -m bundle exec unicorn -p 3000
#   echo "utility started"
# else
#   echo "could not start utility: app is already running"
# fi
cd $current_dir
